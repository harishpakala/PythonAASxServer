{% extends "homelayout.html" %}
{% block homecontent %}
<div class="d-flex align-items-start">
		<div class="row" style = "width: 100%; margin-bottom : 2.5vh;">
			<div class = "col-3">
				<div class="row justify-content-center align-items-center" style="padding-left: 1.5vw; text-align: center; font-size: 0.75vw; width: 100%;">
					<div class="col-12 d-flex justify-content-center">
						<div style="background-color: #0035d5; border:1px solid; border-color: #0035d5; border-top-right-radius: 2vh;border-top-left-radius: 2vh; width: 100%; height: 15vh; color: white; display: flex; align-items: center; justify-content: center; text-align: center;">
							<p><b style='font-size: 115%;'>AAS ID</b> 
							<br><br> 
							<span>{{aasIdentifier_Text}} </span>
							</p>
							<br>
						</div>
					</div>
					<div class="col-12">
						<div style="height:45vh; overflow: hidden; border-right:1px solid;border-left:1px solid; border-color: #0035d5;">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 850">
								<style>.j{fill:#0035d5;}.k{fill:#fff;}</style></defs><g id="a"/><g id="b"><path class="j" d="M551.09,214.02H129.23c-6.86,0-13.4,2.93-18.06,8.1l-39.75,44.01c-4.23,4.68-6.58,10.83-6.58,17.22v253.2c0,13.98,11.03,25.31,24.64,25.31h16.52c13.61,0,24.64-11.33,24.64-25.31v-33.39c0-6.35,2.32-12.47,6.51-17.14l16.91-18.88c4.67-5.21,11.24-8.17,18.13-8.17H506.96c6.47,0,12.69,2.62,17.3,7.29l19.35,19.59c4.7,4.76,7.34,11.25,7.34,18.03v32.67c0,13.98,11.03,25.31,24.64,25.31h15.25c13.61,0,24.64-11.33,24.64-25.31v-253.2c0-6.39-2.35-12.54-6.58-17.22l-39.75-44.01c-4.66-5.16-11.21-8.1-18.06-8.1Z"/><g><path class="k" d="M170.35,383.52l-6.44,24.2h-37.75l42.75-134.61h45.98l42.76,134.61h-37.75l-6.44-24.2h-43.11Zm32.74-38.95c-3.94-14.74-7.69-30.63-10.91-45.37h-.36c-3.22,14.75-6.98,30.63-11.09,45.37l-2.5,9.26h27.37l-2.5-9.26Z"/><path class="k" d="M322.61,383.52l-6.44,24.2h-37.75l42.75-134.61h45.98l42.76,134.61h-37.75l-6.44-24.2h-43.11Zm32.74-38.95c-3.94-14.74-7.69-30.63-10.91-45.37h-.36c-3.22,14.75-6.98,30.63-11.09,45.37l-2.5,9.26h27.37l-2.5-9.26Z"/><path class="k" d="M541.59,313.95h-37.57c0-9.83-5.36-15.31-15.74-15.31-8.95,0-14.13,4.16-14.13,10.4,0,7.75,5.91,10.02,23.08,14.37,25.05,6.43,47.05,14.18,47.05,43.86,0,26.85-20.39,43.49-54.21,43.49s-54.92-17.02-54.92-46.7h38.64c0,11.35,5.55,17.21,17.53,17.21,9.66,0,15.21-4.54,15.21-11.53,0-8.51-6.26-10.4-22.36-14.74-24.69-7-46.51-13.8-46.51-42.73,0-25.52,19.32-42.16,52.42-42.16s51.52,14.94,51.52,43.87Z"/></g><circle id="c" class="j" cx="487.27" cy="159.56" r="19.4"/><path id="d" class="j" d="M399.99,175.27c-5.42-9.33-5.42-20.85,0-30.18,5.8-6.77,15.99-7.55,22.75-1.75,.63,.54,1.21,1.13,1.75,1.75,5.42,9.33,5.42,20.85,0,30.18-5.79,6.77-15.97,7.56-22.74,1.77-.63-.54-1.22-1.13-1.77-1.77Zm4.84-25.91c-3.17,6.87-3.17,14.78,0,21.65,1.47,2.69,4.35,4.29,7.41,4.12,3.04,.19,5.92-1.41,7.38-4.09,3.09-6.9,3.09-14.8,0-21.7-1.45-2.68-4.32-4.27-7.36-4.09-3.06-.17-5.95,1.43-7.43,4.12h0Z"/><circle id="e" class="j" cx="340.41" cy="83.58" r="19.4"/><path id="f" class="j" d="M253.12,99.3c-5.42-9.33-5.42-20.85,0-30.18,5.8-6.77,15.99-7.55,22.75-1.75,.63,.54,1.21,1.13,1.75,1.75,5.42,9.33,5.42,20.85,0,30.18-5.79,6.77-15.97,7.56-22.74,1.77-.63-.54-1.22-1.13-1.77-1.77Zm4.84-25.91c-3.17,6.87-3.17,14.78,0,21.65,1.47,2.69,4.35,4.29,7.41,4.12,3.04,.19,5.92-1.41,7.38-4.09,3.09-6.9,3.09-14.8,0-21.7-1.45-2.68-4.32-4.27-7.36-4.09-3.06-.17-5.95,1.43-7.43,4.12h0Z"/><path id="g" class="j" d="M258.1,144.95h14.54v40.03h-6.42v-34.01h-8.13v-6.01Z"/><circle id="h" class="j" cx="340.41" cy="158.62" r="19.4"/><circle id="i" class="j" cx="190.38" cy="158.47" r="19.4"/></g>
								<image  x="190" y="480" style="width: 18vw; height: 45vh" xlink:href="{{exDomain}}config{{thumbNail}}" />
							</svg>
						</div>
					</div>
					<div class="col-12 d-flex justify-content-center">
						<div style="background-color: #08088A; box-shadow: 0 0.3vw 0.3vh 0 rgba(0, 0, 0, 0.2), 0 0.3vw 0.3vh 0 rgba(0, 0, 0, 0.19); border:1px solid; border-color: #0035d5; border-bottom-right-radius: 2vh; border-bottom-left-radius: 2vh; width: 100%; height: 10vh; color: white; display: flex; align-items: center; justify-content: center; text-align: center;">
							<p><b style='font-size: 115%;'>ASSET ID</b><br><br> {{assetIdentifier}} <br></p>
						</div>
					</div>
				</div>
		   	</div>
			<div class = "col-6">
				<div class="row" style="padding-left : 1.5vw; border: 1px solid rgb(0, 52, 215); border-radius: 2vh; box-shadow: 0 17px 50px 0 rgba(0,0,0,.19), 0 12px 15px 0 rgba(0,0,0,.24);">
				 <div style="overflow-x: auto; height: 70vh"> 
				 <div class="container mt-2">
					<ul class="nav nav-tabs" id="dppTabs" role="tablist">
					{% for idShort,submodel in std_submodels_preexist.items() %}
					  <li class="nav-item" role="presentation">
						<a class="nav-link {% if loop.first %}active{% endif %}" id="{{idShort}}-tab" data-bs-toggle="tab" data-bs-target="#{{idShort}}" type="button" role="tab" aria-controls="{{idShort}}" aria-selected="true">{{idShort}}</a>
					  </li>
					 {% endfor %}
					</ul>
					<div class="tab-content" id="myTabContent">
					{% for idShort,submodel in std_submodels_preexist.items() %}
					  <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="{{idShort}}" role="tabpanel" aria-labelledby="{{idShort}}-tab">
					  <div class="accordion" id="SubmodelAccordin">
												<div class="accordion-item">
												  <div id="submodelCollapse{{idShort}}" class="accordion-collapse collapse show" aria-labelledby="submodelHeading" data-bs-parent="#SubmodelAccordin" style="border-left:1px solid rgba(0,40,205,1); border-right:1px solid rgba(0,40,205,1); border-bottom:1px solid rgba(0,40,205,1);"></div>
												</div>
											</div>
					  </div>
					 {% endfor %}
					</div>
				 </div>
					
				</div>
				</div>
			</div>
			<div class = "col-3">
				
				<div class= "row" style = "padding-top :5vh;">	
					<div class = "col-8 std-submodel-text" >
						<span>Submodel Template Instantiation</span>
					</div>
					<div class = "col-4">
						<div class="std-submodel-add" style = "margin-left : 30%">
							<img style = "height : 4vh;cursor: pointer;" id = "std-submodel-img" data-bs-toggle="modal" data-bs-target="#new_std_submodel_modal" data-whatever="@mdo" src="{{exDomain}}web/images/plus_blue.svg">
							<div class="std-submodel-add-overlay">
								<img  style = "height : 4vh;cursor: pointer;" id = "std-submodel-img-overlay" data-bs-toggle="modal" data-bs-target="#new_std_submodel_modal" data-whatever="@mdo" src="{{exDomain}}web/images/plus1.svg">
							</div>
						</div>	
					</div>
				</div>
				<div class= "row" style = "padding-top :5vh;">
					<div class = "col-8 std-submodel-text" >
						<span>Add New Submodel</span>
					</div>
					<div class = "col-4">
						<div class="std-submodel-add" style = "margin-left : 30%">
							<img style = "height : 4vh;cursor: pointer;" id = "std-submodel-img" data-bs-toggle="modal" data-bs-target="#new_submodel_modal" data-whatever="@mdo" src="{{exDomain}}web/images/plus_blue.svg">
							<div class="std-submodel-add-overlay">
								<img  style = "height : 4vh;cursor: pointer;" id = "std-submodel-img-overlay" data-bs-toggle="modal" data-bs-target="#new_submodel_modal" data-whatever="@mdo" src="{{exDomain}}web/images/plus1.svg">
							</div>
						</div>	
					</div>
				</div>
				<div class= "row" style = "padding-top :5vh;">	
					<div class = "col-8 skill-text"   style="text-align :right">
						<span>Unlock Production STEP</span>
					</div>
					<div class = "col-4">
						<div class="skill-add" style = "margin-left : 30%">
							<img style = "height : 4vh;cursor: pointer;" id = "skill-add-img" data-bs-toggle="modal" data-bs-target="#new_skill_model" data-whatever="@mdo" src="{{exDomain}}web/images/plus_blue.svg">
							<div class="skill-aad-overlay">
								<img  style = "height : 4vh;cursor: pointer;" id = "skill-add-img-overlay" data-bs-toggle="modal" data-bs-target="#new_skill_model" data-whatever="@mdo" src="{{exDomain}}web/images/plus1.svg">
							</div>
						</div>	
					</div>
				</div>
				<div class= "row" style = "padding-top :5vh;">	
					<div class = "col-8 std-submodel-text" >
						<span>Download the JSON File</span>
					</div>
					<div class = "col-4">
						<div class="std-submodel-add" style = "margin-left : 30%">
						<form id = "dataForm" action="/shells/{{aasIdentifier}}/webui" method="post" enctype="multipart/form-data" >
							<input id="operation_type" name="operation_type" type="hidden" value="download_json">
							<input type = "image" style = "height : 4vh;cursor: pointer;" id = "std-submodel-img" src="{{exDomain}}web/images/download.svg">
							<div class="std-submodel-add-overlay">
								<input type = "image"  style = "height : 4vh;cursor: pointer;" id = "std-submodel-img-overlay" src="{{exDomain}}web/images/download1.svg">
							</div>
							</form>
						</div>	
					</div>
				</div>				
			</div>
		</div>
		
		<div class="row" style="min-height : 2.5vh"></div>
</div>

<div class="modal fade" data-bs-backdrop="static" id="new_std_submodel_modal" tabindex="-1" aria-labelledby="i" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered">
	<div class="modal-content">
	  <div class="modal-header">
		<h5 class="modal-title">Add Standard Submodels</h5>
		<button type="button" class="btn-close" data-bs-dismiss="modal" id = "close_btn_newAAS" aria-label="Close">
		</button>
	  </div>
	  <div class="modal-body">
	  	<div class="container">
	  	<form id = "dataForm" action="/shells/{{aasIdentifier}}/webui" method="post" enctype="multipart/form-data" >
			<input id="operation_type" name="operation_type" type="hidden" value="std_submodel">
			<div class="row">
				<div class = "col-5">
					<select style = "height : 6.5vh" name ="submodel-name" class="form-select" aria-label="Default select example">
					  {% for _submodel in std_submodels %}
					  <option value="{{_submodel}}">{{_submodel}}</option>
					  {% endfor %}	
					</select>				
				</div>
				<div class = "col-1">
				</div>
				<div class = "col-5">
					<div class="form-floating">
						<input style = "height : 6.5vh" type="text" class="form-control" id="submodel-IdShort" name="submodel-IdShort" required="required"><label for="submodel-IdShort">Please provide the IdShort</label>
					</div>
				</div>
			</div>	  		

			<div class="row" style="min-height : 2.5vh; border-bottom : 0.1vh solid #dee2e6 "></div>
			<div class="row" style="min-height : 2.5vh;"></div>
			<div class="row">
				<div class="container">
					<div class="row">
						<div class="col-9"></div>
						<div class="col-2">
							<button class="btn btn-primary" id="btn_newAAS">ADD</button>
						</div>
					</div>
				</div>
			</div>
		</form>
		</div>
	  </div>
	</div>
  </div>
</div>

<div class="modal fade" data-bs-backdrop="static" id="new_skill_model" tabindex="-1" aria-labelledby="i" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered">
	<div class="modal-content">
	  <div class="modal-header">
		<h5 class="modal-title">Unlock Production Step</h5>
		<button type="button" class="btn-close" data-bs-dismiss="modal" id = "close_btn_skill" aria-label="Close">
		</button>
	  </div>
	  <div class="modal-body">
	  	<div class="container">
	  	<form id = "dataForm" action="/shells/{{aasIdentifier}}/webui" method="post" enctype="multipart/form-data" >
			<input id="operation_type" name="operation_type" type="hidden" value="available_skills">
			<div class="row">
				<select name ="skill_name" class="form-select" aria-label="Default select example">
				  	{% for skill_name in available_skills %}
					<option value="{{skill_name}}">{{skill_name}}</option>
					{% endfor %}	
				</select>
			</div>	  		
			<div class="row" style="min-height : 2.5vh"></div>
			
			<div class="row">
				<div class="container">
					<div class="row">
						<div class="col-9"></div>
						<div class="col-2">
							<button class="btn btn-primary" id="btn_newAAS">ADD</button>
						</div>
					</div>
				</div>
			</div>
		</form>
		</div>
	  </div>
	</div>
  </div>
</div>

<div class="modal fade" data-bs-backdrop="static" id="new_submodel_modal" tabindex="-1" aria-labelledby="i" aria-hidden="true">
<div class="modal-dialog modal-dialog-centered">
	<div class="modal-content">
	  <div class="modal-header">
		<h5 class="modal-title">Add Submodel</h5>
		<button type="button" class="btn-close" data-bs-dismiss="modal" id = "close_btn_newAAS" aria-label="Close">
		</button>
	  </div>
	  <div class="modal-body">
	  	<div id = "new_Submodel">
	  		<form onsubmit="createNewSubmodel1(event,'submodel-form','{{aasIdentifier}}');return false;">
				<div class="submodel-form" id = "submodel-form">
					
				</div>
			<div class="row" style="min-height : 2.5vh;"></div>
			<div class="row">
				<div class="container">
					<div class="row">
						<div class="col-9"></div>
						<div class="col-2">
							<button class="btn btn-primary">ADD</button>
						</div>
					</div>
				</div>
			</div>
			</form>
		</div>
	  </div>
	</div>
  </div>
</div>

<script>
$('#new_submodel_modal').on('show.bs.modal', function (e) {
	addSubmodeltoForm('{{exDomain}}');
});
</script>


<script>

var aasIdentifier = '{{aasIdentifier}}';

var submodelCollapse = []	
var linearData1 = {};
var linearData = {};

// Initialize tree
var tree = {
    Assembly: { value: "BOM", parent: "" },
};

// Jinja-Objekt in JavaScript-Variable laden
var submodelsData = {{ std_submodels_preexist | tojson | safe }};
let idx = 0;
for (const [idShort, submodel] of Object.entries(submodelsData)){
	
	try {
		var submodelTemp = submodel;
		var submodelD = submodel;
    } catch (error) {
		console.error("ERROR WHILE EXECUTING JSON PARSER:", error.message);
        continue; // Weiter zum nächsten Schleifen-Durchlauf
	}
	addSubmodelElements("elem21",'{{ exDomain }}',idx,submodelTemp);
idx = idx + 1;    
}

function addSubmodelElements(parent,exdomain,idx,submodelTemp){
	var submodelId = submodelTemp["id"];
	var submodelElems = document.createElement('ul');
	submodelElems.setAttribute("class","list-group list-group-flush");
	submodelElems.setAttribute("id","submodelElems");
	
	if (submodelTemp.hasOwnProperty("submodelElements")){
		
		for (var elemC of submodelTemp["submodelElements"]){
			if (elemC["modelType"] == "SubmodelElementCollection" || elemC["modelType"] == "SubmodelElementList" || elemC["modelType"] == "Entity" || elemC["modelType"] == "AnnotatedRelationshipElement") {
				var elemLi = document.createElement('li');	
				elemLi.setAttribute("class","list-group-item");
				elemLi.setAttribute("id","li_"+elemC["idShort"]);
				elemLi.appendChild(processCollection(elemC,elemC["idShort"],exdomain,submodelId));
				submodelElems.appendChild(elemLi);
			}
			else {
				let elemChild = setSubmodelElemData(elemC,"",exdomain,submodelId);
				submodelElems.appendChild(elemChild);			
			}
			
		}
		var submodelCollapse = document.getElementById("submodelCollapse"+submodelTemp["idShort"]);
		submodelCollapse.appendChild(submodelElems);
	}
	
	var arrow = "<span style='font-size: 20px; font-weight: bold;'>&nbsp;&nbsp;&nbsp;&rarr;&nbsp;</span>";
}

function processCollection(collectionElem,_pidShort,exdomain,submodelId){
	var idShort = collectionElem["idShort"];
	var modelType = collectionElem["modelType"];
	var collectionDiv = document.createElement('div');
	collectionDiv.setAttribute("class","accordion");
	collectionDiv.setAttribute("id",_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps"));
	var accordinCollpase = createCollapseAccordin(_pidShort,idShort);

	for (var elemC of collectionElem["value"]){

		if (elemC["modelType"] == "SubmodelElementCollection" || elemC["modelType"] == "SubmodelElementList" || elemC["modelType"] == "Entity" || elemC["modelType"] == "AnnotatedRelationshipElement"){
			var elemLi = document.createElement('li');	
			elemLi.setAttribute("class","list-group-item");			
			accordinCollpase.appendChild(processCollection(elemC,_pidShort+"."+elemC["idShort"],exdomain,submodelId));			
		}
		else {
			accordinCollpase.appendChild(setSubmodelElemData(elemC,_pidShort,exdomain,submodelId));
		}
	}
	
	var accordinDiv = document.createElement('div');
	accordinDiv.setAttribute("class","accordion-item");
	accordinDiv.appendChild(creatAccordinHeader(_pidShort,idShort,modelType,collectionElem));
	
	
	accordinDiv.appendChild(accordinCollpase);
	collectionDiv.appendChild(accordinDiv);
	return collectionDiv	
}
function setSubmodelElemData(elemC,_pidShort,exdomain,submodelId){
	var modelType = elemC["modelType"];
	var idShort = elemC["idShort"];
	var elemLi = document.createElement('li');
	elemLi.setAttribute("class","list-group-item");
	elemLi.setAttribute("id","li_"+idShort);
	elemLi.setAttribute("style","font-size : 1.1em");

	
	var arrow = "<span style='font-size: 20px; font-weight: bold;'>&nbsp;&nbsp;&nbsp;&rarr;&nbsp;</span>";
	
	if (modelType == "Property" || modelType == "File" ){
		elemLi.innerHTML =  idShort +"   =   " +elemC["value"].toString();
	}
	if (modelType == "Range"){
		elemLi.innerHTML = idShort +"   =   " +elemC["min"].toString() + ".." +elemC["max"].toString();
	}
	if (elemC.modelType == "MultiLanguageProperty"){
		try {	
			
			// Retrieving language string
			var mlp_text;
				// Selecting english entry
			for (const langString of elemC["value"]) {
				  if (langString["language"] === "en") {
						mlp_text = langString["text"];
					break; 
				  }
				}
				// If no english entry available, select the first entry
			if (!mlp_text && elemC["value"].length > 0) {
					mlp_text = elemC["value"][0].text;
			}
			// Write entry to the right of the property name in the accordion header
			elemLi.innerHTML = idShort + arrow + mlp_text;
			}
			catch(err) {
				elemLi.innerHTML = idShort;
			}
	}
	if (modelType == "ReferenceElement" ){
		elemLi.innerHTML = idShort + arrow;
	}
	
	
	return elemLi;
}

function creatAccordinHeader(_pidShort,idShort, modelType, collectionElem){
	var h2 = document.createElement('h2');
	h2.setAttribute("class","accordion-header");
	h2.setAttribute("id",_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps")+"_Header");
	h2.setAttribute("style","background-color : rgb(0,52,215,0.9)");															 
	h2.appendChild(createAccordinHeaderButton(_pidShort,idShort, modelType, collectionElem))
	return h2;
}

function createAccordinHeaderButton(_pidShort,idShort, modelType, collectionElem){
	var arrow = "<span style='font-size: 20px; font-weight: bold;'>&nbsp;&nbsp;&nbsp;&rarr;&nbsp;</span>";
	var button = document.createElement('button');
	button.setAttribute("class","accordion-button collapsed");
	button.setAttribute("style","color :white;font-size : 0.5em");
	button.setAttribute("type","button");
	button.setAttribute("data-bs-toggle","collapse");
	button.setAttribute("data-bs-target","#"+_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps")+"_Collapse");
	button.setAttribute("aria-controls",_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps")+"_Collapse");
	
	if (modelType != "AnnotatedRelationshipElement"){
	button.innerHTML = idShort + " ("+modelType+")";
	}
	else{
		var elemC = collectionElem;
		var firstRelationList = elemC.first._object.keys._list;
		var secondRelationList = elemC.second._object.keys._list;

		if (firstRelationList.length > 0) {
			var child = firstRelationList[firstRelationList.length - 1]._object.value.text;
			var lastElementFirst =" <b>" + child + "</b> (subject)";
			} else {var lastElementFirst = "no subject defined";}
		
		if (secondRelationList.length > 0) {
			var parent = secondRelationList[secondRelationList.length - 1]._object.value.text;
			var lastElementSecond =" <b>" + parent + "</b> (object)";
			} else {var lastElementSecond = "no object defined";}	
	
	payload ="";
	
	updateTreeData("add", child , parent, payload);
	
	var contentDiv = document.createElement('div');
	contentDiv.innerHTML = idShort + " (" + modelType + ")<br>" + arrow + " " + lastElementFirst + " is related to " + lastElementSecond;
	button.appendChild(contentDiv);	
	}
	
	return button;
}

function createCollapseAccordin(_pidShort,idShort, colorcode){
	var CollapseAccordinDiv = document.createElement('div');
	CollapseAccordinDiv.setAttribute("class","accordion-collapse collapse");
	CollapseAccordinDiv.setAttribute("id",_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps")+"_Collapse");
	CollapseAccordinDiv.setAttribute("aria-labelledby",_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps")+"_Header");
	CollapseAccordinDiv.setAttribute("data-bs-parent","#"+_pidShort.replaceAll(".", "_").replace(/@/g, "at_").replace(/\{[0-9]+\}/g, "clamps"));
	CollapseAccordinDiv.setAttribute("style","border:3px dotted; border-color:rgba(30, 130, 76, 1);");
	
	return CollapseAccordinDiv; 
}

function seperaterRow(minHeight){
	var divRow = document.createElement('div');
	divRow.setAttribute("style","min-height:"+minHeight);
	return divRow;
}

// Tree relation array for BOM
function updateTreeData(action, child, parent, payload) {
    if (action === "add") {
            tree[child] = { value: child, parent: parent, payload: payload };
    } else if (action === "del") {
            delete tree[child];    
    }
}


$(document).ready(function () {

	$('.accordion-header').on('click', function () {
		$('.accordion-item').removeClass('focus');
		$(this).closest('.accordion-item').addClass('focus');
	});

	$('.accordion').on('hidden.bs.collapse', function () {
		$('.accordion-item').removeClass('focus');
	});
});

</script>
{% endblock %}
    
